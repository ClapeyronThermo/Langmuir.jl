<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparing the estimation of isosteric heat from isotherms with Langmuir.jl · Langmuir.jl</title><meta name="title" content="Comparing the estimation of isosteric heat from isotherms with Langmuir.jl · Langmuir.jl"/><meta property="og:title" content="Comparing the estimation of isosteric heat from isotherms with Langmuir.jl · Langmuir.jl"/><meta property="twitter:title" content="Comparing the estimation of isosteric heat from isotherms with Langmuir.jl · Langmuir.jl"/><meta name="description" content="Documentation for Langmuir.jl."/><meta property="og:description" content="Documentation for Langmuir.jl."/><meta property="twitter:description" content="Documentation for Langmuir.jl."/><meta property="og:url" content="https://ClapeyronThermo.github.io/Langmuir.jl/tutorials/isosteric_heat/"/><meta property="twitter:url" content="https://ClapeyronThermo.github.io/Langmuir.jl/tutorials/isosteric_heat/"/><link rel="canonical" href="https://ClapeyronThermo.github.io/Langmuir.jl/tutorials/isosteric_heat/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/logo.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Langmuir.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Langmuir.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../background/">Background</a></li><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorial/">A typical workflow with Langmuir.jl</a></li><li class="is-active"><a class="tocitem" href>Comparing the estimation of isosteric heat from isotherms with Langmuir.jl</a></li></ul></li><li><a class="tocitem" href="../../models/models/">Supported models</a></li><li><a class="tocitem" href="../../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Comparing the estimation of isosteric heat from isotherms with Langmuir.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparing the estimation of isosteric heat from isotherms with Langmuir.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ClapeyronThermo/Langmuir.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ClapeyronThermo/Langmuir.jl/blob/main/docs/src/tutorials/isosteric_heat.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="isosteric"><a class="docs-heading-anchor" href="#isosteric">Comparing the estimation of isosteric heat from isotherms with Langmuir.jl</a><a id="isosteric-1"></a><a class="docs-heading-anchor-permalink" href="#isosteric" title="Permalink"></a></h1><p>During adsorption, heat is released as adsorbate molecules transition to a lower energy state on the adsorbent surface compared to the bulk gas phase. This released heat partially accumulates in the adsorbent, causing a temperature rise on its surface, which in turn can decelerate the adsorption process - as adsorption is an exothermic process.</p><p>Predicting equilibrium loading at a given temperature and pressure often receives greater focus. However, accurately predicting the energy release as a function of these same variables is equally critical, as it is as impactful as loading in the adsorption process.</p><p>On an energetically heterogeneous surface, the isosteric heat decreases as surface loading increases. Isotherms like the single-site Langmuir model, which assume a constant heat of adsorption regardless of surface loading, are therefore often inadequate for accurately representing experimental data in many cases.</p><p>Other isotherms can account for surface heterogeneity such as Toth:</p><p class="math-container">\[n = \frac{MKP}{(1 + M(K P)^f)^{1/f}}\]</p><p>However, exhibits an unrealistic infinitely large negative value at high surface loading. below you can see the behavior of the isosteric heat for the toth isotherm as a function of the loading. You can also see the comparison of the analytical expression (which is very tedious to derive) and the one given by <code>Langmuir.jl</code> with automatic differentiation.</p><pre><code class="language-julia hljs">using Langmuir, Plots
toth = Toth(7.464, 3.6e-7, 8.3144*-5649.81, 0.5, 50.22)
p_range = 1e-5:10.0:10*101325.0 |&gt; collect
loading_350_t = loading_at_T(toth, p_range, 350.0)
loading_300_t = loading_at_T(toth, p_range, 300.0)
ΔH_350_t = map(p -&gt; isosteric_heat(toth, p, 350.0), p_range)
ΔH_300_t = map(p -&gt; isosteric_heat(toth, p, 300.0), p_range)
plot(loading_300_t/toth.M, ΔH_300_t, framestyle=:box, title = &quot;Toth&quot;, xlabel = &quot;covered fraction&quot;, ylabel = &quot;ΔH (J/mol)&quot;, label = &quot;Automatic Differentiation - 300 K&quot;)
plot!(loading_350_t/toth.M, ΔH_350_t, framestyle=:box, label = &quot;Automatic Differentiation - 350 K&quot;)

function Q_st1(model::Toth, n1, T)
    E1 = model.E
    β = model.β
    R = 8.3144  # Assuming Rgas gives the gas constant for the type of T
    f = model.f₀ - model.β / T
    n1_0 = model.M  # Assuming saturation loading as reference loading

    # Calculate the two terms inside the brackets in the equation
    term1 = log.(n1 ./ n1_0) ./ (1 .- (n1 ./ n1_0).^f)
    term2 = log.((n1 ./ n1_0) ./ (1 .- (n1 ./ n1_0).^f).^(1/f))

    # Calculate Q_st1 using the main formula
    Q_st1_value = E1 .+ (β * R / f) * (term2 .- term1)
    return Q_st1_value
end

ΔH_analytical = Q_st1(toth, loading_350_t, 350.0)

plot!(loading_350_t/toth.M, ΔH_analytical, label = &quot;Analytical - 350 K&quot;, color = :slateblue2)</code></pre><img src="fa27db01.svg" alt="Example block output"/><p>It can be noticed that the isosteric heat for the Toth isotherm blows for high surface coverages. </p><p>Multi-site Langmuir can also account for surface heterogeneity. Below you can see the behavior of the isosteric heat as a function of the surface coverage.</p><pre><code class="language-julia hljs">dualsite = MultiSite(LangmuirS1(2.337, 6.6e-11, 8.3144*-5340.87),
 LangmuirS1(3.490, 3.4e-11, 8.3144*-4273.13))
p_range = 1e-5:10.0:10*101325.0 |&gt; collect
loading_270 = loading_at_T(dualsite, p_range, 270.0)
loading_350 = loading_at_T(dualsite, p_range, 350.0)
ΔH_270 = map(p -&gt; isosteric_heat(dualsite, p, 270.0), p_range)
ΔH_350 = map(p -&gt; isosteric_heat(dualsite, p, 350.0), p_range)
plot(loading_270/(2.337 + 3.490), ΔH_270, framestyle=:box, title = &quot;Dualsite Langmuir&quot;, xlabel = &quot;covered fraction&quot;, ylabel = &quot;ΔH (J/mol)&quot;, label = &quot;270 K&quot;)
plot!(loading_350/(2.337 + 3.490), ΔH_350, framestyle=:box, label = &quot;350 K&quot;)</code></pre><img src="140a08cb.svg" alt="Example block output"/><p>It can bee seen that the isosteric heat presents an s-shape varying from more energetic to less energetic sites.</p><p><a href="https://doi.org/10.1007/s10450-020-00296-3">Some literature</a> points that these behaviors are non-physical and potentially problematic when trying to model thermal effects in adsorption.</p><p>To overcome it, the adsorption Nonrandom Two-Liquid (aNRTL) activity coefficient model into an activity-based formulation for Langmuir isotherm, <a href="https://doi.org/10.1007/s10450-019-00185-4">Chang et al. 2020</a> proposed a thermodynamic Langmuir (tL) which seems to have superior properties for predicting the isosteric heat compared to Toth and Multisite Langmuir.</p><p>The equation for the loading <span>$n_i$</span> in terms of <span>$\gamma_i$</span> and <span>$\gamma_\phi$</span> is:</p><p class="math-container">\[n_i = \frac{M K_i P}{\frac{\gamma_i}{\gamma_\phi} + K_i P}\]</p><p>where <span>$K_i$</span> is also a function of temperature <span>$K_i = K_i^\circ\exp{\frac{-E}{RT}}$</span>, and the activity coefficients <span>$\gamma_i$</span> and <span>$\gamma_\phi$</span> are given by:</p><p class="math-container">\[\gamma_i = \exp\left(\frac{d \frac{g^E}{RT}}{d \theta_i}\right)\]</p><p class="math-container">\[\gamma_\phi = \exp\left(\frac{d \frac{g^E}{RT}}{d \theta_{\phi}}\right)\]</p><p>The Gibbs excess free energy term, <span>$\frac{g^E}{RT}$</span>, is expressed as:</p><p class="math-container">\[\frac{g^E}{RT} = \frac{\theta_i \theta_\phi \tau_{i\phi} (G_{i\phi} - 1)}{\theta_i G_{i\phi} + \theta_\phi}\]</p><p>where, <span>$B_{i\phi}$</span> is a model parameter, <span>$\tau_{i\phi} = B_{i\phi} / T$</span>, <span>$G_{i\phi} = \exp(-0.3 \cdot \tau_{i\phi})$</span>.</p><p>Here, <span>$\theta_i$</span> and <span>$\theta_\phi$</span> are the coverage terms for the adsorbed species and adsorption sites,  respectively (<span>$\theta_i  + \theta_{\phi} = 1$</span>), and <span>$T$</span> is the temperature.</p><p>Below you can see how to iniatilize the thermodynamic langmuir model in <code>Langmuir.jl</code> and use it to predict the loading and isosteric heat.</p><pre><code class="language-julia hljs">tlang = ThermodynamicLangmuir(5.890, 6.1e-11, -4599.86*8.3144, -762.51)
p_range = 1e-5:10.0:10*101325.0 |&gt; collect
loading_270 = loading_at_T(tlang, p_range, 270.0)
loading_350 = loading_at_T(tlang, p_range, 350.0)
ΔH_270 = map(p -&gt; isosteric_heat(tlang, p, 270.0), p_range)
ΔH_350 = map(p -&gt; isosteric_heat(tlang, p, 350.0), p_range)
plot(loading_270/tlang.M, ΔH_270, framestyle=:box, xlabel = &quot;covered fraction&quot;, ylabel = &quot;ΔH (J/mol)&quot;, title = &quot;tLangmuir&quot;, label = &quot;270 K&quot;)
plot!(loading_350/tlang.M, ΔH_350, framestyle=:box, label = &quot;350 K&quot;)
plot!([minimum(loading_270), maximum(loading_270)]./tlang.M,  [-4599.86*8.3144, -4599.86*8.3144], label = &quot;Langmuir&quot;)</code></pre><img src="8e57199f.svg" alt="Example block output"/><p>It is evident that the thermodynamic Langmuir model exhibits behavior that is notably different from both the Toth and multisite Langmuir models. <a href="https://link.springer.com/article/10.1007/s10450-019-00185-4">As highlighted in existing literature</a>, the thermodynamic Langmuir model offers more accurate estimates of isosteric heat while maintaining high predictive accuracy for equilibrium loading. It can also be use to predict binary adsorption. </p><p>Analytical expressions for the isosteric heat can become quite extensive. In fact, there is an <a href="https://aiche.onlinelibrary.wiley.com/doi/10.1002/aic.17186">entire manuscript</a> dedicated to deriving such expressions for a number of isotherms. </p><p>In <code>Langmuir.jl</code>, we leverage automatic differentiation to get accurate estimates of the required derivatives for the isosteric heat without requiring such extensive derivations.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« A typical workflow with Langmuir.jl</a><a class="docs-footer-nextpage" href="../../models/models/">Supported models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Tuesday 27 May 2025 01:13">Tuesday 27 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
