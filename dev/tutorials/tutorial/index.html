<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>A typical workflow with Langmuir.jl · Langmuir.jl</title><meta name="title" content="A typical workflow with Langmuir.jl · Langmuir.jl"/><meta property="og:title" content="A typical workflow with Langmuir.jl · Langmuir.jl"/><meta property="twitter:title" content="A typical workflow with Langmuir.jl · Langmuir.jl"/><meta name="description" content="Documentation for Langmuir.jl."/><meta property="og:description" content="Documentation for Langmuir.jl."/><meta property="twitter:description" content="Documentation for Langmuir.jl."/><meta property="og:url" content="https://ClapeyronThermo.github.io/Langmuir.jl/tutorials/tutorial/"/><meta property="twitter:url" content="https://ClapeyronThermo.github.io/Langmuir.jl/tutorials/tutorial/"/><link rel="canonical" href="https://ClapeyronThermo.github.io/Langmuir.jl/tutorials/tutorial/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/logo.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Langmuir.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Langmuir.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../background/">Background</a></li><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>A typical workflow with Langmuir.jl</a></li><li><a class="tocitem" href="../isosteric_heat/">Comparing the estimation of isosteric heat from isotherms with Langmuir.jl</a></li><li><a class="tocitem" href="../multicomponent/">Finding the best isotherm for your data with Langmuir.jl</a></li></ul></li><li><a class="tocitem" href="../../models/models/">Supported models</a></li><li><a class="tocitem" href="../../reference/">Reference</a></li><li><a class="tocitem" href="../../references/">Bibliography</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>A typical workflow with Langmuir.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>A typical workflow with Langmuir.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ClapeyronThermo/Langmuir.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ClapeyronThermo/Langmuir.jl/blob/main/docs/src/tutorials/tutorial.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial"><a class="docs-heading-anchor" href="#Tutorial">A typical workflow with Langmuir.jl</a><a id="Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial" title="Permalink"></a></h1><p>In this tutorial, we will go through a typical workflow for processing and analyzing adsorption equilibrium data:</p><ol><li><strong>Loading adsorption data</strong> for the pure components in the mixture of interest.</li><li><strong>Fitting an isotherm</strong> for each component.</li><li><strong>Analyzing the fitting quality</strong> by:<ul><li>Plotting predictions vs. experimental data.</li><li>Performing residual analysis.</li></ul></li><li><strong>Estimating single-component properties</strong> such as the isosteric heat of adsorption.</li><li><strong>Estimating multicomponent adsorption loading</strong> using the Ideal Adsorbed Solution Theory (IAST).</li></ol><p>For this tutorial, we will work with a binary system consisting of ethane and ethylene. The goal is to investigate their adsorption properties in DUT-8, a material known for being ethane-selective.</p><p>This case study is based on the research presented in the following paper:</p><ul><li><strong>Reference:</strong> Santana, V. V., Carmo, P., Seabra, R., Rodrigues, A. E., Ribeiro, A. M., Nogueira, I. B. R., Yoon, J. W., Cho, K. H., Yun, J. S., Lee, U.-H., Kim, K., Ferreira, A. F. P. (2024). <em>Ethylene Purification by Pressure Swing Adsorption with the Paraffin Selective Metal–Organic Framework─DUT-8</em>. <strong>Industrial &amp; Engineering Chemistry Research</strong>, 63(5), 2307–2319. <a href="https://doi.org/10.1021/acs.iecr.3c02808">DOI: 10.1021/acs.iecr.3c02808</a>.</li></ul><p>Ethane and ethylene data are stored in  <code>ethane_tpl_data.csv</code> and <code>ethylene_tpl.csv</code> files. To read csv files, many options are available in Julia. Here, we will use <code>DelimitedFiles.jl</code>. We also use the <code>isotherm_data</code> function to wrap the data into a format suitable for processing the data with Langmuir.jl. The data files contain pressure, loading, and temperature information for each component. <strong>Note that keeping this order is crucial</strong> for the <code>isotherm_data</code> function to work correctly.</p><p>In the file, pressure unit is in bar, temperature in Kelvin and loading in mmol/g or mol/kg. </p><p>Let&#39;s read and visualize the isotherms at the different temperatures. You can use a custom plotting function to visualize the data by calling <code>plot(data, temperature)</code>. This function will plot the pressure against the loading for a given temperature.</p><pre><code class="language-julia hljs">using Plots, DelimitedFiles, Langmuir
ethane_data_path = joinpath(@__DIR__, &quot;sample_data/ethane_tpl_data.csv&quot;)
ethylene_data_path = joinpath(@__DIR__, &quot;sample_data/ethylene_tpl_data.csv&quot;)
ethane_data = readdlm(ethane_data_path, &#39;,&#39;)
P_ethane = ethane_data[:, 2]*1e5 # Convert bar to Pa
T_ethane = ethane_data[:, 1]
l_ethane = ethane_data[:, 3]
d_ethane = isotherm_data(P_ethane, l_ethane, T_ethane)

ethylene_data = readdlm(ethylene_data_path, &#39;,&#39;)
P_ethylene = ethylene_data[:, 2]*1e5 # Convert bar to Pa
T_ethylene = ethylene_data[:, 1]
l_ethylene = ethylene_data[:, 3]
d_ethylene = isotherm_data(P_ethylene, l_ethylene, T_ethylene) #Alwas read in order of Pressure, Loading, Temperature

figsize = (500, 500/1.618)
plot(d_ethane, 283.0, label = &quot;Ethane at 283K&quot;, m = (3, :white, stroke(1, :blue)), size = figsize, xlabel = &quot;Pressure (Pa)&quot;, ylabel = &quot;Loading (mol/kg)&quot;, markershape = :circle)
plot!(d_ethane, 323.0, label = &quot;Ethane at 323K&quot;, markershape = :square, m = (3, :white, stroke(1, :blue)))

plot!(d_ethylene, 283.0, label = &quot;Ethylene at 283K&quot;, markershape = :circle,
m = (3, :white, stroke(1, :red)))
scatter!(d_ethylene, 323.0, label = &quot;Ethylene at 323K&quot;,
markershape = :square, m = (3, :white, stroke(1, :red)))</code></pre><img src="6f5090dc.svg" alt="Example block output"/><p>Following the reference manuscript, the quadratic isotherm is the chosen model for fitting the data. In this tutorial, the same strategy is used. Note that the bounds for the parameters were be manually set since the default ones were too large. Once the bounds are custom, you also need to provide the initial guess. We have default initial guesses for each isotherm, but to expose it, you need to <code>import</code> the <code>x0_guess_fit</code> function. We also import the <code>to_vec</code> function to convert the initial guess into a vector format, which is required by the fitting problem.</p><p>Also observe that the argument next to d_ethane is <code>nothing</code>. This is because the fitting problem does not involve any additional data, such as calorimetric data, to estimate the isotherm parameters.</p><pre><code class="language-julia hljs">import Langmuir: x0_guess_fit, to_vec
#Fitting ethane
x0_ethane = to_vec(x0_guess_fit(Quadratic, d_ethane))
lb_ethane = (1e-25, 1e-25, 1e-4, -80_000.0, -80_000.0)
ub_ethane = (1e-1, 1e-1, 100., -1_000.0, -1_000.0)

prob_ethane = IsothermFittingProblem(Quadratic{eltype(d_ethane)}, d_ethane, nothing, abs2, x0_ethane, lb_ethane, ub_ethane) #Bounds have to be manually tweaked. Default interval is too large
alg = DEIsothermFittingSolver(max_steps = 500, population_size = 150,
logspace = true, verbose = true)
loss_fit_ethane, ethane_isotherm = fit(prob_ethane, alg)
println(&quot;Fitting loss for ethane is $loss_fit_ethane&quot;)
println(ethane_isotherm)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Starting optimization with optimizer BlackBoxOptim.DiffEvoOpt{BlackBoxOptim.FitPopulation{Float64}, BlackBoxOptim.RadiusLimitedSelector, BlackBoxOptim.AdaptiveDiffEvoRandBin{3}, BlackBoxOptim.RandomBound{BlackBoxOptim.ContinuousRectSearchSpace}}
0.00 secs, 0 evals, 0 steps
DE modify state:
0.50 secs, 84467 evals, 84172 steps, improv/step: 0.146 (last = 0.1457), fitness=1.784575323
DE modify state:

Optimization stopped after 142579 steps and 0.78 seconds
Termination reason: Too many steps (101) without any function evaluations (probably search has converged)
Steps per second = 182600.26
Function evals per second = 160422.45
Improvements/step = Inf
Total function evaluations = 125262


Best candidate found: [-15.1983, -42.9896, 1.29228, 8.83902, 10.7746]

Fitness: 1.784575323

Fitting loss for ethane is 1.7845753228742514
Quadratic{Float64}(2.508747925860674e-7, 2.1373377905470402e-19, 3.641079634213087, -6898.207461420056, -47789.59996812821)</code></pre><p>The fitting results can be visualized by plotting the isotherm predictions against the experimental data. The <code>plot!</code> function can be used to overlay the fitted isotherm on the experimental data. This is also a custom case of the <code>plot</code> function from the <code>Plots.jl</code> to facilitate the visualization of isotherms. You can use it to plot the isotherm predictions for a specific temperature and pressure range. </p><pre><code class="language-julia hljs">#Plotting ethane fitting
plot!(ethane_isotherm, 283.0, (0.0, maximum(P_ethane)),
color = :blue, label = &quot;Quadratic Ethane - 283.0 K&quot;, linestyle = :dash)
plot!(ethane_isotherm, 323.0, (0.0, maximum(P_ethane)),
color = :blue, label = &quot;Quadratic Ethane - 323.0 K&quot;)</code></pre><img src="a05921ed.svg" alt="Example block output"/><pre><code class="language-julia hljs">#Fitting Ethylene
x0_ethylene = to_vec(x0_guess_fit(Quadratic, d_ethylene))
lb_ethylene = (1e-25, 1e-25, 1e-4, -80_000.0, -80_000.0)
ub_ethylene = (1e-1, 1e-1, 100., -500.0, -500.0)
prob_ethylene = IsothermFittingProblem(Quadratic{eltype(d_ethylene)}, d_ethylene, nothing, abs2, x0_ethylene, lb_ethylene, ub_ethylene)
loss_fit_ethylene, ethylene_isotherm = fit(prob_ethylene, alg)
println(&quot;Fitting loss for ethane is $loss_fit_ethylene&quot;)
println(ethylene_isotherm)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Starting optimization with optimizer BlackBoxOptim.DiffEvoOpt{BlackBoxOptim.FitPopulation{Float64}, BlackBoxOptim.RadiusLimitedSelector, BlackBoxOptim.AdaptiveDiffEvoRandBin{3}, BlackBoxOptim.RandomBound{BlackBoxOptim.ContinuousRectSearchSpace}}
0.00 secs, 0 evals, 0 steps
DE modify state:
0.50 secs, 84772 evals, 84432 steps, improv/step: 0.151 (last = 0.1509), fitness=0.357323989
DE modify state:

Optimization stopped after 151716 steps and 0.85 seconds
Termination reason: Too many steps (101) without any function evaluations (probably search has converged)
Steps per second = 178344.21
Function evals per second = 164389.69
Improvements/step = Inf
Total function evaluations = 139845


Best candidate found: [-17.4655, -41.785, 1.34342, 9.37504, 10.6383]

Fitness: 0.357323989

Fitting loss for ethane is 0.35732398929797954
Quadratic{Float64}(2.5992272633497714e-8, 7.128314007737299e-19, 3.8321392356701924, -11790.383813866743, -41702.74716050827)</code></pre><pre><code class="language-julia hljs">#Plotting ethylene isotherms
plot!(ethylene_isotherm, 283.0, (0.0, maximum(P_ethane)),
label = &quot;Quadratic Ethylene - 283.0 K&quot;, linestyle = :dash, color = :red)
plot!(ethylene_isotherm, 323.0, (0.0, maximum(P_ethane)),
label = &quot;Quadratic Ethylene - 283.0 K&quot;, color = :red)</code></pre><img src="5886ab65.svg" alt="Example block output"/><p>From the fitting results, the isotherm parameters closely match those reported in the reference manuscript. For example, the parameter <code>M</code> was estimated at 3.68 in the manuscript, while it is 3.64 in this analysis. However, the energy parameters exhibit a greater discrepancy. Without calorimetric data, it&#39;s challenging to determine the accuracy of these values, as parameter identifiability is limited when relying solely on loading data.</p><pre><code class="language-julia hljs">#Ethane isosteric heat
is_283K = d_ethane.T .== 283.0
P_C₂_283K = d_ethane.p[is_283K]
l_C₂_283K = d_ethane.l[is_283K]
ΔH_C₂_283K = isosteric_heat.(ethane_isotherm, P_C₂_283K, 283.0)

#Ethylene isosteric heat
is_283K_ethylene = d_ethylene.T .== 283.0
P_C₂₌_283K = d_ethylene.p[is_283K_ethylene]
l_C₂₌_283K = d_ethylene.l[is_283K_ethylene]
ΔH_C₂₌_283K = isosteric_heat.(ethylene_isotherm, P_C₂₌_283K, 283.0)

scatter(l_C₂_283K, ΔH_C₂_283K, xlabel = &quot;Loading (mol/kg)&quot;, ylabel = &quot;Isosteric Heat (J/mol)&quot;, m = (4, :white, stroke(1, :lightslateblue)), markershape = :circle, label = &quot;Ethane - 283.0 K&quot;, size = (600, 300))
scatter!(l_C₂₌_283K, ΔH_C₂₌_283K, xlabel = &quot;Loading (mol/kg)&quot;, ylabel = &quot;Isosteric Heat (J/mol)&quot;, markershape = :square, m = (3, :white, stroke(1, :springgreen2)), label = &quot;Ethylene - 283.0 K&quot;)</code></pre><img src="bc139f08.svg" alt="Example block output"/><p>The plot shows the isosteric heat of adsorption for ethane and ethylene at 283.0 K as a function of loading. Ethane exhibits a steeper decline in adsorption heat, suggesting stronger initial interactions that weaken significantly as loading increases, whereas ethylene&#39;s decline is more gradual, indicating a slower reduction in adsorption strength. </p><p>Lastly, the final analysis will utilize IAST to make predictions on the binary adsorption of ethane and ethylene. There are two ways to use IAST in Langmuir.jl.  You can directly use the <code>iast</code> function, which gives you access to extra solution parameters such as convergence criteria, total loading and composition. Another way is to wrap the isotherms into the <code>IASTModels</code> type and use it to estimate quantities such as the loading and the isosteric heat. Below, we are using the first approach, which is more straightforward for this case.</p><pre><code class="language-julia hljs">y_C₂ = range(0.0, 1.00, 51) #51 points from 0.0 to 1.0
success_y_C₂ = []
x_C₂ = []
x_C₂₌ = []
p = 1*101325.0
T = 303.0
for y_C₂_ᵢ in y_C₂
   y = [y_C₂_ᵢ, (1.0 - y_C₂_ᵢ)]
   models = [ethane_isotherm, ethylene_isotherm]
   (n_total, x, is_success) = iast(models, p, T, y, FastIAS(), maxiters = 1500, abstol = 1e-10, reltol = 1e-10)

   if is_success == :success
      println(is_success)

      push!(x_C₂, x[1])
      push!(x_C₂₌, x[2])
      push!(success_y_C₂, y_C₂_ᵢ)

      else

      nothing

   end
end

plot(x_C₂, success_y_C₂, xlabel = &quot;x (adsorbed phase)&quot;, ylabel = &quot;y (gas phase)&quot;, label = &quot;ethane&quot;, framestyle=:box, size = (600, 300))
plot!(x_C₂₌, 1.0 .- success_y_C₂, label = &quot;ethylene&quot;)</code></pre><img src="bd0c5b00.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started/">« Getting Started</a><a class="docs-footer-nextpage" href="../isosteric_heat/">Comparing the estimation of isosteric heat from isotherms with Langmuir.jl »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 14 July 2025 22:29">Monday 14 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
