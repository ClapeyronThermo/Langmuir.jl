<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · Langmuir.jl</title><meta name="title" content="Tutorial · Langmuir.jl"/><meta property="og:title" content="Tutorial · Langmuir.jl"/><meta property="twitter:title" content="Tutorial · Langmuir.jl"/><meta name="description" content="Documentation for Langmuir.jl."/><meta property="og:description" content="Documentation for Langmuir.jl."/><meta property="twitter:description" content="Documentation for Langmuir.jl."/><meta property="og:url" content="https://ClapeyronThermo.github.io/Langmuir.jl/tutorials/tutorial/"/><meta property="twitter:url" content="https://ClapeyronThermo.github.io/Langmuir.jl/tutorials/tutorial/"/><link rel="canonical" href="https://ClapeyronThermo.github.io/Langmuir.jl/tutorials/tutorial/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/logo.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Langmuir.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Langmuir.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../background/">Background</a></li><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li class="is-active"><a class="tocitem" href>Tutorial</a></li><li><a class="tocitem" href="../../models/models/">Supported models</a></li><li><a class="tocitem" href="../../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ClapeyronThermo/Langmuir.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ClapeyronThermo/Langmuir.jl/blob/main/docs/src/tutorials/tutorial.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial"><a class="docs-heading-anchor" href="#Tutorial">A complete tutorial with Langmuir.jl</a><a id="Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial" title="Permalink"></a></h1><p>In this tutorial, we will go through a typical workflow for processing and analyzing adsorption equilibrium data:</p><ol><li><strong>Loading adsorption data</strong> for the pure components in the mixture of interest.</li><li><strong>Fitting an isotherm</strong> for each component.</li><li><strong>Analyzing the fitting quality</strong> by:<ul><li>Plotting predictions vs. experimental data.</li><li>Performing residual analysis.</li></ul></li><li><strong>Estimating single-component properties</strong> such as the isosteric heat of adsorption.</li><li><strong>Estimating multicomponent adsorption loading</strong> using the Ideal Adsorbed Solution Theory (IAST).</li></ol><p>For this tutorial, we will work with a binary system consisting of ethane and ethylene. The goal is to investigate their adsorption properties in DUT-8, a material known for being ethane-selective.</p><p>This case study is based on the research presented in the following paper:</p><ul><li><strong>Reference:</strong> Santana, V. V., Carmo, P., Seabra, R., Rodrigues, A. E., Ribeiro, A. M., Nogueira, I. B. R., Yoon, J. W., Cho, K. H., Yun, J. S., Lee, U.-H., Kim, K., Ferreira, A. F. P. (2024). <em>Ethylene Purification by Pressure Swing Adsorption with the Paraffin Selective Metal–Organic Framework─DUT-8</em>. <strong>Industrial &amp; Engineering Chemistry Research</strong>, 63(5), 2307–2319. <a href="https://doi.org/10.1021/acs.iecr.3c02808">DOI: 10.1021/acs.iecr.3c02808</a>.</li></ul><p>Ethane and ethylene data are stored in  <code>ethane_tpl_data.csv</code> and <code>ethylene_tpl.csv</code> files. To read csv files, many options are available in Julia. Here, we will use <code>DelimitedFiles.jl</code>.</p><p>In the file, pressure unit is in bar, temperature in Kelvin and loading in mmol/g or mol/kg. </p><p>Let&#39;s read and visualize the isotherms at the different temperatures.</p><pre><code class="language-julia hljs">using Plots, DelimitedFiles, Langmuir
ethane_data_path = joinpath(@__DIR__, &quot;sample_data/ethane_tpl_data.csv&quot;)
ethylene_data_path = joinpath(@__DIR__, &quot;sample_data/ethylene_tpl_data.csv&quot;)
ethane_data = readdlm(ethane_data_path, &#39;,&#39;)
P_ethane = ethane_data[:, 2]*1e5
T_ethane = ethane_data[:, 1]
l_ethane = ethane_data[:, 3]
d_ethane = isotherm_data(P_ethane, l_ethane, T_ethane)
Ts_ethane, lp_ethane = split_data_by_temperature(d_ethane)

ethylene_data = readdlm(ethylene_data_path, &#39;,&#39;)
P_ethylene = ethylene_data[:, 2]*1e5
T_ethylene = ethylene_data[:, 1]
l_ethylene = ethylene_data[:, 3]
d_ethylene = isotherm_data(P_ethylene, l_ethylene, T_ethylene)
Ts_ethylene, lp_ethylene = split_data_by_temperature(d_ethylene)


scatter(lp_ethane[1][2], lp_ethane[1][1], label = &quot;T = 283.00 K (Ethane)&quot;,
xlabel = &quot;Pressure [Pa]&quot;, ylabel = &quot;loading [mol/kg]&quot;, m = (4, :white, stroke(1, :slateblue2)),framestyle=:box, markershape = :circle, size = (600, 300))
scatter!(lp_ethane[3][2], lp_ethane[3][1], label = &quot;T = 323.00 K (Ethane)&quot;, m = (4, :white, stroke(1, :lightslateblue)), markershape = :circle)

scatter!(lp_ethylene[1][2], lp_ethylene[1][1], label = &quot;T = 283.00 K (Ethylene)&quot;, color = :mediumspringgreen, markershape = :square, m = (3, :white, stroke(1, :springgreen2)))
scatter!(lp_ethylene[3][2], lp_ethylene[3][1], label = &quot;T = 323.00 K (Ethylene)&quot;,
markershape = :square, m = (3, :white, stroke(1, :springgreen2)))</code></pre><img src="e0910377.svg" alt="Example block output"/><p>Following the reference manuscript, the quadratic isotherm is the chosen model for fitting the data. In this tutorial, the same strategy is used.</p><pre><code class="language-julia hljs">import Langmuir: x0_guess_fit, to_vec
#Fitting ethane
x0_ethane = to_vec(x0_guess_fit(Quadratic, d_ethane))
lb_ethane = (1e-25, 1e-25, 1e-4, -80_000.0, -80_000.0)
ub_ethane = (1e-1, 1e-1, 100., -1_000.0, -1_000.0)

prob_ethane = IsothermFittingProblem(Quadratic{eltype(d_ethane)}, d_ethane, nothing, abs2, x0_ethane, lb_ethane, ub_ethane) #Bounds have to be manually tweaked. Default interval is too large
alg = DEIsothermFittingSolver(max_steps = 5000, population_size = 50,
logspace = true, verbose = true)
loss_fit_ethane, ethane_isotherm = fit(prob_ethane, alg)
println(&quot;Fitting loss for ethane is $loss_fit_ethane&quot;)
println(ethane_isotherm)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Starting optimization with optimizer BlackBoxOptim.DiffEvoOpt{BlackBoxOptim.FitPopulation{Float64}, BlackBoxOptim.RadiusLimitedSelector, BlackBoxOptim.AdaptiveDiffEvoRandBin{3}, BlackBoxOptim.RandomBound{BlackBoxOptim.ContinuousRectSearchSpace}}
0.00 secs, 0 evals, 0 steps
DE modify state:

Optimization stopped after 42033 steps and 0.28 seconds
Termination reason: Too many steps (101) without any function evaluations (probably search has converged)
Steps per second = 148397.48
Function evals per second = 140842.22
Improvements/step = Inf
Total function evaluations = 39893


Best candidate found: [-15.1983, -42.9896, 1.29228, 8.83902, 10.7746]

Fitness: 0.007827085

Fitting loss for ethane is 0.007827084749448475
Quadratic{Float64}(2.5087482698420104e-7, 2.1373377526197646e-19, 3.641079631515442, -6898.20708031339, -47789.60001500269)</code></pre><pre><code class="language-julia hljs">#Plotting ethane fitting
loading1_ethane = loading_at_T(ethane_isotherm, lp_ethane[1][2], Ts_ethane[1])
loading3_ethane = loading_at_T(ethane_isotherm, lp_ethane[3][2], Ts_ethane[3])
plot!(sort(lp_ethane[1][2]), sort(loading1_ethane), color = :slateblue2, label = &quot;Quadratic - 283.0 K&quot;)
plot!(sort(lp_ethane[2][2]), sort(loading3_ethane), color = :slateblue2, label = &quot;Quadratic - 323.0 K&quot;)</code></pre><img src="cb3966d4.svg" alt="Example block output"/><pre><code class="language-julia hljs">#Fitting Ethylene
x0_ethylene = to_vec(x0_guess_fit(Quadratic, d_ethylene))
lb_ethylene = (1e-25, 1e-25, 1e-4, -80_000.0, -80_000.0)
ub_ethylene = (1e-1, 1e-1, 100., -500.0, -500.0)
prob_ethylene = IsothermFittingProblem(Quadratic{eltype(d_ethylene)}, d_ethylene, nothing, abs2, x0_ethylene, lb_ethylene, ub_ethylene)
loss_fit_ethylene, ethylene_isotherm = fit(prob_ethylene, alg)
println(&quot;Fitting loss for ethane is $loss_fit_ethylene&quot;)
println(ethylene_isotherm)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Starting optimization with optimizer BlackBoxOptim.DiffEvoOpt{BlackBoxOptim.FitPopulation{Float64}, BlackBoxOptim.RadiusLimitedSelector, BlackBoxOptim.AdaptiveDiffEvoRandBin{3}, BlackBoxOptim.RandomBound{BlackBoxOptim.ContinuousRectSearchSpace}}
0.00 secs, 0 evals, 0 steps
DE modify state:

Optimization stopped after 48747 steps and 0.24 seconds
Termination reason: Too many steps (101) without any function evaluations (probably search has converged)
Steps per second = 201676.40
Function evals per second = 182814.88
Improvements/step = Inf
Total function evaluations = 44188


Best candidate found: [-17.4655, -41.785, 1.34342, 9.37504, 10.6383]

Fitness: 0.001567210

Fitting loss for ethane is 0.0015672104793771065
Quadratic{Float64}(2.599227350906123e-8, 7.128313806215397e-19, 3.832139235999132, -11790.383728687304, -41702.74723166111)</code></pre><pre><code class="language-julia hljs">#Plotting ethylene isotherms
loading1_ethylene = loading_at_T(ethylene_isotherm, lp_ethylene[1][2], Ts_ethylene[1])
loading3_ethylene = loading_at_T(ethylene_isotherm, lp_ethylene[1][2], Ts_ethylene[3])
plot!(sort(lp_ethylene[1][2]), sort(loading1_ethylene), color = :springgreen2, label = &quot;Quadratic - 283.0 K&quot;)
plot!(sort(lp_ethylene[1][2]), sort(loading3_ethylene), color = :springgreen2, label = &quot;Quadratic - 323.0 K&quot;)</code></pre><img src="63dc2173.svg" alt="Example block output"/><p>From the fitting results, the isotherm parameters closely match those reported in the reference manuscript. For example, the parameter <span>$M$</span> was estimated at 3.68 in the manuscript, while it is 3.64 in this analysis. However, the energy parameters exhibit a greater discrepancy. Without calorimetric data, it&#39;s challenging to determine the accuracy of these values, as parameter identifiability is limited when relying solely on loading data.</p><pre><code class="language-julia hljs">#Ethane isosteric heat
P_C₂_283K = sort(lp_ethane[1][2][2:end])
l_C₂_283K = sort(loading1_ethane[2:end])
ΔH_C₂_283K = map(p -&gt; isosteric_heat(ethane_isotherm, p, 283.0), P_C₂_283K)

#Ethylene isosteric heat
P_C₂₌_283K = sort(lp_ethylene[1][2][2:end])
l_C₂₌_283K = sort(loading1_ethylene[2:end])
ΔH_C₂₌_283K = map(p -&gt; isosteric_heat(ethylene_isotherm, p, 283.0), P_C₂₌_283K)

scatter(l_C₂_283K, -ΔH_C₂_283K, xlabel = &quot;Loading (mol/kg)&quot;, ylabel = &quot;Isosteric Heat (J/mol)&quot;, m = (4, :white, stroke(1, :lightslateblue)), markershape = :circle, label = &quot;Ethane - 283.0 K&quot;, size = (600, 300))
scatter!(l_C₂₌_283K, -ΔH_C₂₌_283K, xlabel = &quot;Loading (mol/kg)&quot;, ylabel = &quot;Isosteric Heat (J/mol)&quot;, markershape = :square, m = (3, :white, stroke(1, :springgreen2)), label = &quot;Ethylene - 283.0 K&quot;)</code></pre><img src="2e2e7390.svg" alt="Example block output"/><p>The plot shows the isosteric heat of adsorption for ethane and ethylene at 283.0 K as a function of loading. Ethane exhibits a steeper decline in adsorption heat, suggesting stronger initial interactions that weaken significantly as loading increases, whereas ethylene&#39;s decline is more gradual, indicating a slower reduction in adsorption strength. </p><p>Lastly, the final analysis will utilize IAST to make predictions on the binary adsorption of ethane and ethylene.</p><pre><code class="language-julia hljs">y_C₂ = range(0.0, 1.00, 51) |&gt; collect
success_y_C₂ = []
x_C₂ = []
x_C₂₌ = []
p = 1*101325.0
T = 303.0
for y_C₂_ᵢ in y_C₂
   y = [y_C₂_ᵢ, (1.0 - y_C₂_ᵢ)]
   models = [ethane_isotherm, ethylene_isotherm]
   (n_total, x, is_success) = iast(models, p, T, y, IASTNestedLoop(), maxiters = 1500, abstol = 1e-10, reltol = 1e-10)

   if is_success == :success
      println(is_success)

      push!(x_C₂, x[1])
      push!(x_C₂₌, x[2])
      push!(success_y_C₂, y_C₂_ᵢ)

      else

      nothing

   end
end

plot(success_y_C₂, x_C₂, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;, label = &quot;ethane&quot;, framestyle=:box, size = (600, 300))
plot!(1.0 .- success_y_C₂, x_C₂₌, label = &quot;ethylene&quot;)</code></pre><img src="facc41d1.svg" alt="Example block output"/><p>Here you can see the x-y plot for both components.  </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started/">« Getting Started</a><a class="docs-footer-nextpage" href="../../models/models/">Supported models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 23 October 2024 16:53">Wednesday 23 October 2024</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
